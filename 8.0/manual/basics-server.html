<html><head><title>Server-side website programming guide</title><meta charset="utf8"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link rel="stylesheet" href="https://ocsigen.org/css/style.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/themes/prism.min.css"/><script type="application/javascript" src="https://ocsigen.org/js/client.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-core.min.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-ocaml.min.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-clike.min.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-reason.min.js">
//<![CDATA[

//]]>
</script><script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-javascript.min.js">
//<![CDATA[

//]]>
</script></head><body class="basics-server tuto"><div class="project-page"><div class="page-header"><p class="logo-ocsigen"><a href=".././../../" class="ocsimore_phrasing_link"><img src=".././../../img/ocsigen-white.svg" alt="Ocsigen"/></a>
</p><div class="mainmenu"><p class="mainmenu-home"><a href=".././../../" class="ocsimore_phrasing_link">Home</a></p><p class="mainmenu-current mainmenu-doc"><a href=".././../../tuto/" class="ocsimore_phrasing_link">Doc</a></p><p><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a></p><p><a href=".././../../js_of_ocaml/" class="ocsimore_phrasing_link">Js_of_ocaml</a></p><p><a href=".././../../ocsigenserver/" class="ocsimore_phrasing_link">Server</a></p><p><a href=".././../../lwt/" class="ocsimore_phrasing_link">Lwt</a></p><p><a href=".././../../tyxml/" class="ocsimore_phrasing_link">Tyxml</a></p><p><a href=".././../../ocsigen-start/" class="ocsimore_phrasing_link">Start</a></p></div><form id="googlesearch" action="https://google.com/search"><input name="q" id="gsearch-box" placeholder="Search using Google"/><label for="gsearch-box"><img src="/img/search.svg" alt="" id="gsearch-icon"/></label><input type="submit" id="gsearch-submit" onclick="document.getElementById('gsearch-box').value += ' site:ocsigen.org';"/></form><aside class="how-drawer"><input id="how-drawer-toggle" type="checkbox"/><label for="how-drawer-toggle" id="how-drawer-label"><span class="how-drawer-icon"></span></label><nav class="how-drawer-content"><ul class="drawermainmenu"><li class="drawermainmenu-home"><a href=".././../../" class="ocsimore_phrasing_link">Home</a>
</li><li class="drawermainmenu-doc"><a href=".././../../tuto/" class="ocsimore_phrasing_link">Doc</a>
</li><li class="drawermainmenu-project"><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a>
</li><li class="drawermainmenu-project"><a href=".././../../js_of_ocaml/" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigenserver/" class="ocsimore_phrasing_link">Server</a>
</li><li class="drawermainmenu-project"><a href=".././../../lwt/" class="ocsimore_phrasing_link">Lwt</a>
</li><li class="drawermainmenu-project"><a href=".././../../tyxml/" class="ocsimore_phrasing_link">Tyxml</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigen-toolkit/" class="ocsimore_phrasing_link">Toolkit</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsigen-start/" class="ocsimore_phrasing_link">Start</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsipersist/" class="ocsimore_phrasing_link">Ocsipersist</a>
</li><li class="drawermainmenu-project"><a href=".././../../html_of_wiki/" class="ocsimore_phrasing_link">html_of_wiki</a>
</li><li class="drawermainmenu-project"><a href=".././../../ocsimore/" class="ocsimore_phrasing_link">Ocsimore (<em>deprecated</em>)</a>
</li><li class="drawermainmenu-page"><a href=".././../../projects" class="ocsimore_phrasing_link">Other projects</a>
</li><li class="drawermainmenu-page"><a href=".././../../papers" class="ocsimore_phrasing_link">Research papers</a>
</li><li class="drawermainmenu-page"><a href=".././../../credits" class="ocsimore_phrasing_link">Who does Ocsigen?</a>
</li><li class="drawermainmenu-page"><a href=".././../../contributing" class="ocsimore_phrasing_link">Contributing</a>
</li><li class="drawermainmenu-page"><a href=".././../../blog" class="ocsimore_phrasing_link">Blog</a>
</li><li class="drawermainmenu-page"><a href=".././../../install" class="ocsimore_phrasing_link">Installation</a>
</li><li class="drawermainmenu-page"><a href="https://github.com/ocsigen" class="ocsimore_phrasing_link">Source code</a>
</li></ul><nav class="how-doctree"><h1> Programmer's guide</h1><h2><a href="intro" class="ocsimore_phrasing_link">Introduction. Ocsigen: where to start?</a></h2><h2><a href="basics" class="ocsimore_phrasing_link">Client-server application programming guide</a></h2><h2><a href="basics-server" class="ocsimore_phrasing_link">Server-side website programming guide</a></h2><h1> Main tutorials</h1><h2><a href=".././../../install" class="ocsimore_phrasing_link">Install Ocsigen</a></h2><h2><a href="start" class="ocsimore_phrasing_link">Your first app in 5 minutes</a></h2><h2><a href="application" class="ocsimore_phrasing_link">Client/server application: Graffiti</a></h2><h2><a href="tutowidgets" class="ocsimore_phrasing_link">Eliom apps basics: writing client-server widgets</a></h2><h2><a href="how-to-register-session-data" class="ocsimore_phrasing_link">Session data: Eliom references</a></h2><h2><a href="tutoreact" class="ocsimore_phrasing_link">Reactive client-server Web applications</a></h2><h2><a href="interaction" class="ocsimore_phrasing_link">Service based Web programming</a></h2><h2><a href="misc" class="ocsimore_phrasing_link">Mixing traditional Web interaction with client-server app</a></h2><h1> 5-minute tutorials</h1><h2><a href="lwt" class="ocsimore_phrasing_link">Lwt</a></h2><h2><a href="html" class="ocsimore_phrasing_link">HTML</a></h2><h1> Other tutorials: Miscellanous features</h1><h2><a href="mobile" class="ocsimore_phrasing_link">Mobile applications with Ocsigen</a></h2><h2><a href="custom-conf" class="ocsimore_phrasing_link">Custom configuration</a></h2><h2><a href="rest" class="ocsimore_phrasing_link">RESTful JSON API</a></h2><h2><a href="ocsipersist" class="ocsimore_phrasing_link">Persistent tables with Ocsipersist</a></h2><h1> Improving Graffiti</h1><h2><a href="pictures" class="ocsimore_phrasing_link">Download pictures</a></h2><h2><a href="music" class="ocsimore_phrasing_link">Playing music</a></h2><h2><a href="reactivemediaplayer" class="ocsimore_phrasing_link">Reactive media player</a></h2><h1 class="howto"> HOW-TO</h1><h2> My first steps with Ocsigen</h2><h3><a href="how-to-make-hello-world-in-ocsigen" class="ocsimore_phrasing_link">How to make &quot;hello world&quot; in Ocsigen</a></h3><h3><a href="how-to-compile-my-ocsigen-pages" class="ocsimore_phrasing_link">How to compile my Ocsigen pages</a></h3><h3><a href="how-to-configure-and-launch-the-ocsigen-server" class="ocsimore_phrasing_link">How to configure and launch the Ocsigen Server</a></h3><h3><a href="how-does-a-page-s-source-code-look" class="ocsimore_phrasing_link">How does a client-server app source code look like?</a></h3><h2> How to put some elements in my page ?</h2><h3><a href="how-to-make-page-a-skeleton" class="ocsimore_phrasing_link">How to make a page skeleton</a></h3><h3><a href="how-to-use-get-parameters-or-parameters-in-the-url" class="ocsimore_phrasing_link">How to use GET parameters (parameters in the URL)</a></h3><h3><a href="how-to-add-css-stylesheet" class="ocsimore_phrasing_link">How to add CSS stylesheet</a></h3><h3><a href="how-to-add-a-javascript-script" class="ocsimore_phrasing_link">How to add a Javascript script</a></h3><h3><a href="how-to-add-a-div" class="ocsimore_phrasing_link">How to add a div</a></h3><h3><a href="how-to-add-a-list" class="ocsimore_phrasing_link">How to add lists in pages?</a></h3><h3><a href="how-to-add-an-image" class="ocsimore_phrasing_link">How to add an image</a></h3><h3><a href="how-to-write-titles-and-paragraphs" class="ocsimore_phrasing_link">How to write titles and paragraphs</a></h3><h3><a href="how-to-set-and-id-classes-or-other-attributes-to-html-elements" class="ocsimore_phrasing_link">How to set and id, classes or other attributes to HTML elements</a></h3><h3><a href="how-to-add-a-select-or-other-form-element" class="ocsimore_phrasing_link">How to add select (or other form element)</a></h3><h3><a href="how-to-insert-raw-form-elements-not-belonging-to-a-form-towards-a-service" class="ocsimore_phrasing_link">How to insert &quot;raw&quot; form elements (not belonging to a form towards a service)</a></h3><h3><a href="how-to-make-responsive-css" class="ocsimore_phrasing_link">How to make responsive CSS</a></h3><h2> Services</h2><h3><a href="how-to-do-links-to-other-pages" class="ocsimore_phrasing_link">How to do links to other pages</a></h3><h3><a href="how-to-write-forms" class="ocsimore_phrasing_link">How to write forms</a></h3><h3><a href="how-to-register-a-service-that-decides-itself-what-to-send" class="ocsimore_phrasing_link">How to register a service that decides itself what to send</a></h3><h3><a href="how-to-create-link-to-a-current-page-without-knowing-its-url" class="ocsimore_phrasing_link">How to create link to a current page (without knowing its URL)</a></h3><h3><a href="how-to-create-form-wizard-sequence-of-pages-depending-on-data-entered-on-previous-ones" class="ocsimore_phrasing_link">How to create form wizard (sequence of pages depending on data entered on previous ones)</a></h3><h3><a href="how-to-write-a-json-service" class="ocsimore_phrasing_link">How to write a JSON service</a></h3><h3><a href="how-to-send-file-download" class="ocsimore_phrasing_link">How to send a file (download)</a></h3><h3><a href="how-to-send-file-upload" class="ocsimore_phrasing_link">How to send a file (upload)</a></h3><h2> Js_of_ocaml</h2><h3><a href="how-to-attach-ocaml-values-to-dom-elements" class="ocsimore_phrasing_link">How to attach OCaml values to DOM elements</a></h3><h3><a href="how-to-know-whether-the-browser-window-has-the-focus-or-not" class="ocsimore_phrasing_link">How to know whether the browser window has the focus or not</a></h3><h3><a href="how-to-build-js-object" class="ocsimore_phrasing_link">How to build js object</a></h3><h3><a href="how-to-stop-default-behaviour-of-events" class="ocsimore_phrasing_link">How to stop default behaviour of events</a></h3><h3><a href="how-to-call-an-ocaml-function-from-js-code" class="ocsimore_phrasing_link">How to call an OCaml function from js code</a></h3><h2> Eliom client-server applications</h2><h3><a href="how-to-call-a-server-side-function-from-client-side" class="ocsimore_phrasing_link">How to call a server-side function from the client side</a></h3><h3><a href="how-to-make-the-client-side-program-get-an-html-element-from-the-server-and-insert-it-in-the-page" class="ocsimore_phrasing_link">How to make the client side program get an HTML element from the server and insert it in the page</a></h3><h3><a href="how-to-attach-ocaml-values-to-the-html-nodes-sent-to-the-client" class="ocsimore_phrasing_link">How to attach OCaml values to the HTML nodes sent to the client</a></h3><h3><a href="how-to-iterate-on-all-sessions-for-one-user-or-all-tabs" class="ocsimore_phrasing_link">How to iterate on all sessions for one user, or all tabs</a></h3><h3><a href="how-to-implement-a-notification-system" class="ocsimore_phrasing_link">How to implement a notification system</a></h3><h3><a href="how-to-send-a-file-to-server-without-stopping-the-client-process" class="ocsimore_phrasing_link">How to send a file to server without stopping the client process</a></h3><h3><a href="how-to-detect-channel-disconnection" class="ocsimore_phrasing_link">How to detect channel disconnection</a></h3><h3><a href="how-to-detect-on-client-side-that-the-server-side-state-for-the-process-is-closed" class="ocsimore_phrasing_link">How to detect on client side that the server side state for the process is closed</a></h3><h2> Eliom Server side</h2><h3><a href="how-do-i-create-a-cryptographically-safe-identifier" class="ocsimore_phrasing_link">How do I create a Cryptographically safe identifier</a></h3><h3><a href="hash-password" class="ocsimore_phrasing_link">Protecting passwords</a></h3></nav></nav></aside></div><p class="reasonwarning">Warning: Reason support is experimental.
We are looking for beta-tester and contributors.
</p><button id="reason">Switch to </button><div class="twocols"><nav class="leftcol">Version <select class="how-versions" onchange="location = this.value;"><option value=".././../dev/manual/basics-server">dev</option><option value=".././../8.0/manual/basics-server" selected="selected">8.0</option><option value=".././../7.1/manual/basics-server">7.1</option><option value=".././../2.2/manual/basics-server">2.2</option></select><nav class="how-doctree"><h1> Programmer's guide</h1><h2><a href="intro" class="ocsimore_phrasing_link">Introduction. Ocsigen: where to start?</a></h2><h2><a href="basics" class="ocsimore_phrasing_link">Client-server application programming guide</a></h2><h2><a href="basics-server" class="ocsimore_phrasing_link">Server-side website programming guide</a></h2><h1> Main tutorials</h1><h2><a href=".././../../install" class="ocsimore_phrasing_link">Install Ocsigen</a></h2><h2><a href="start" class="ocsimore_phrasing_link">Your first app in 5 minutes</a></h2><h2><a href="application" class="ocsimore_phrasing_link">Client/server application: Graffiti</a></h2><h2><a href="tutowidgets" class="ocsimore_phrasing_link">Eliom apps basics: writing client-server widgets</a></h2><h2><a href="how-to-register-session-data" class="ocsimore_phrasing_link">Session data: Eliom references</a></h2><h2><a href="tutoreact" class="ocsimore_phrasing_link">Reactive client-server Web applications</a></h2><h2><a href="interaction" class="ocsimore_phrasing_link">Service based Web programming</a></h2><h2><a href="misc" class="ocsimore_phrasing_link">Mixing traditional Web interaction with client-server app</a></h2><h1> 5-minute tutorials</h1><h2><a href="lwt" class="ocsimore_phrasing_link">Lwt</a></h2><h2><a href="html" class="ocsimore_phrasing_link">HTML</a></h2><h1> Other tutorials: Miscellanous features</h1><h2><a href="mobile" class="ocsimore_phrasing_link">Mobile applications with Ocsigen</a></h2><h2><a href="custom-conf" class="ocsimore_phrasing_link">Custom configuration</a></h2><h2><a href="rest" class="ocsimore_phrasing_link">RESTful JSON API</a></h2><h2><a href="ocsipersist" class="ocsimore_phrasing_link">Persistent tables with Ocsipersist</a></h2><h1> Improving Graffiti</h1><h2><a href="pictures" class="ocsimore_phrasing_link">Download pictures</a></h2><h2><a href="music" class="ocsimore_phrasing_link">Playing music</a></h2><h2><a href="reactivemediaplayer" class="ocsimore_phrasing_link">Reactive media player</a></h2><h1 class="howto"> HOW-TO</h1><h2> My first steps with Ocsigen</h2><h3><a href="how-to-make-hello-world-in-ocsigen" class="ocsimore_phrasing_link">How to make &quot;hello world&quot; in Ocsigen</a></h3><h3><a href="how-to-compile-my-ocsigen-pages" class="ocsimore_phrasing_link">How to compile my Ocsigen pages</a></h3><h3><a href="how-to-configure-and-launch-the-ocsigen-server" class="ocsimore_phrasing_link">How to configure and launch the Ocsigen Server</a></h3><h3><a href="how-does-a-page-s-source-code-look" class="ocsimore_phrasing_link">How does a client-server app source code look like?</a></h3><h2> How to put some elements in my page ?</h2><h3><a href="how-to-make-page-a-skeleton" class="ocsimore_phrasing_link">How to make a page skeleton</a></h3><h3><a href="how-to-use-get-parameters-or-parameters-in-the-url" class="ocsimore_phrasing_link">How to use GET parameters (parameters in the URL)</a></h3><h3><a href="how-to-add-css-stylesheet" class="ocsimore_phrasing_link">How to add CSS stylesheet</a></h3><h3><a href="how-to-add-a-javascript-script" class="ocsimore_phrasing_link">How to add a Javascript script</a></h3><h3><a href="how-to-add-a-div" class="ocsimore_phrasing_link">How to add a div</a></h3><h3><a href="how-to-add-a-list" class="ocsimore_phrasing_link">How to add lists in pages?</a></h3><h3><a href="how-to-add-an-image" class="ocsimore_phrasing_link">How to add an image</a></h3><h3><a href="how-to-write-titles-and-paragraphs" class="ocsimore_phrasing_link">How to write titles and paragraphs</a></h3><h3><a href="how-to-set-and-id-classes-or-other-attributes-to-html-elements" class="ocsimore_phrasing_link">How to set and id, classes or other attributes to HTML elements</a></h3><h3><a href="how-to-add-a-select-or-other-form-element" class="ocsimore_phrasing_link">How to add select (or other form element)</a></h3><h3><a href="how-to-insert-raw-form-elements-not-belonging-to-a-form-towards-a-service" class="ocsimore_phrasing_link">How to insert &quot;raw&quot; form elements (not belonging to a form towards a service)</a></h3><h3><a href="how-to-make-responsive-css" class="ocsimore_phrasing_link">How to make responsive CSS</a></h3><h2> Services</h2><h3><a href="how-to-do-links-to-other-pages" class="ocsimore_phrasing_link">How to do links to other pages</a></h3><h3><a href="how-to-write-forms" class="ocsimore_phrasing_link">How to write forms</a></h3><h3><a href="how-to-register-a-service-that-decides-itself-what-to-send" class="ocsimore_phrasing_link">How to register a service that decides itself what to send</a></h3><h3><a href="how-to-create-link-to-a-current-page-without-knowing-its-url" class="ocsimore_phrasing_link">How to create link to a current page (without knowing its URL)</a></h3><h3><a href="how-to-create-form-wizard-sequence-of-pages-depending-on-data-entered-on-previous-ones" class="ocsimore_phrasing_link">How to create form wizard (sequence of pages depending on data entered on previous ones)</a></h3><h3><a href="how-to-write-a-json-service" class="ocsimore_phrasing_link">How to write a JSON service</a></h3><h3><a href="how-to-send-file-download" class="ocsimore_phrasing_link">How to send a file (download)</a></h3><h3><a href="how-to-send-file-upload" class="ocsimore_phrasing_link">How to send a file (upload)</a></h3><h2> Js_of_ocaml</h2><h3><a href="how-to-attach-ocaml-values-to-dom-elements" class="ocsimore_phrasing_link">How to attach OCaml values to DOM elements</a></h3><h3><a href="how-to-know-whether-the-browser-window-has-the-focus-or-not" class="ocsimore_phrasing_link">How to know whether the browser window has the focus or not</a></h3><h3><a href="how-to-build-js-object" class="ocsimore_phrasing_link">How to build js object</a></h3><h3><a href="how-to-stop-default-behaviour-of-events" class="ocsimore_phrasing_link">How to stop default behaviour of events</a></h3><h3><a href="how-to-call-an-ocaml-function-from-js-code" class="ocsimore_phrasing_link">How to call an OCaml function from js code</a></h3><h2> Eliom client-server applications</h2><h3><a href="how-to-call-a-server-side-function-from-client-side" class="ocsimore_phrasing_link">How to call a server-side function from the client side</a></h3><h3><a href="how-to-make-the-client-side-program-get-an-html-element-from-the-server-and-insert-it-in-the-page" class="ocsimore_phrasing_link">How to make the client side program get an HTML element from the server and insert it in the page</a></h3><h3><a href="how-to-attach-ocaml-values-to-the-html-nodes-sent-to-the-client" class="ocsimore_phrasing_link">How to attach OCaml values to the HTML nodes sent to the client</a></h3><h3><a href="how-to-iterate-on-all-sessions-for-one-user-or-all-tabs" class="ocsimore_phrasing_link">How to iterate on all sessions for one user, or all tabs</a></h3><h3><a href="how-to-implement-a-notification-system" class="ocsimore_phrasing_link">How to implement a notification system</a></h3><h3><a href="how-to-send-a-file-to-server-without-stopping-the-client-process" class="ocsimore_phrasing_link">How to send a file to server without stopping the client process</a></h3><h3><a href="how-to-detect-channel-disconnection" class="ocsimore_phrasing_link">How to detect channel disconnection</a></h3><h3><a href="how-to-detect-on-client-side-that-the-server-side-state-for-the-process-is-closed" class="ocsimore_phrasing_link">How to detect on client side that the server side state for the process is closed</a></h3><h2> Eliom Server side</h2><h3><a href="how-do-i-create-a-cryptographically-safe-identifier" class="ocsimore_phrasing_link">How do I create a Cryptographically safe identifier</a></h3><h3><a href="hash-password" class="ocsimore_phrasing_link">Protecting passwords</a></h3></nav></nav><article class="rightcol"><h1>Server-side website programming guide</h1><p>While Eliom is well known for its unique client-server programming
model, it is also perfectly suited to programming more traditional
websites. This page describes how you can generate Web pages in OCaml,
and handle links, forms, page parameters, sessions, etc. You will see
that you can get very quickly a working Web site without having to learn
innovative concepts and this might be enough for your needs.
</p><p>You will then learn how Eliom is simplifying the programming of very
common behaviours by introducing innovative concepts like scoped
sessions or continuation-based Web programming.
</p><p>Programming with Eliom will make your website ready for future
evolutions by allowing you to introduce progressively client-side
features like event handlers, fully in OCaml. You will even be able to
turn your website into a <a href="basics" class="ocsimore_phrasing_link">distributed client-server Web app</a>,
and even a mobile app if needed in the future, without having to rewrite
anything.
</p><div id="overview" class="ocsimore_outline"><header><p><strong>Table of contents</strong></p></header></div><script>
//<![CDATA[
window.addEventListener("load", function(){ outline([0,-515484383,0,0,[0,"nav",[0,"aside",0]],"overview",1]); }, false); 
//]]>
</script><section class="docblock"><header><h2>OCaml</h2></header><p>This programming guide assumes you know the <em>OCaml</em> language.
Many resources and books are available online.</p></section><section class="docblock"><header><h2>Lwt</h2></header><p><em>Lwt</em> is a concurrent programming library for OCaml, initially written
by Jérôme Vouillon in 2001 for the
<a href="https://github.com/bcpierce00/unison" class="ocsimore_phrasing_link">Unison</a> file synchronizer.
It provides an alternative to the more usual preemptive threads approach
for programming concurrent applications, that avoids most problems of concurrent
data access and deadlocks.
It is used by Ocsigen Server and Eliom and has now become one of the
standard ways to implement concurrent applications in OCaml.
All your Web sites must be written in Lwt-compatible way!
</p><div class="focused"><h3>How it works</h3><p>Instead of calling blocking functions, like <span class="teletype">Unix.sleep</span>
or <span class="teletype">Unix.read</span>, that could block the entire program, replace them
by their cooperative counterparts (<span class="teletype">Lwt_unix.sleep</span>,
<span class="teletype">Lwt_unix.read</span>, etc.). Instead of taking time to execute,
they always return immediately a <em>promise</em> of the result,
of type <span class="teletype">'a Lwt.t</span>. This type is abstract, and the only way
to use the result is to <em>bind</em> a function to the promise.
<span class="teletype">Lwt.bind p f</span> means: &quot;when promise <span class="teletype">p</span> is completed, give its result
to function <span class="teletype">f</span>&quot;.
</p><p>Syntax <span class="teletype">let%lwt x = p in e</span> is equivalent to <span class="teletype">Lwt.bind p (fun x -&gt; e)</span>
and makes it very natural to sequentialize computations without blocking the rest
of the program.</p></div><p>To learn Lwt, read this <a href="lwt" class="ocsimore_phrasing_link">short tutorial</a>, or its <a href=".././../../lwt/" class="ocsimore_phrasing_link">user manual</a>.</p></section><section class="docblock"><header><h2>Ocsigen Server: A full featured extensible Web server in OCaml</h2></header><p>Ocsigen Server can be used either as a library for you OCaml programs, or as
an executable, taking its configuration from a file (and with dynamic linking).
</p><p>Extensions add features to the server. For example, Staticmod makes it possible
to serve static files, Deflatemod to compress the output, Redirectmod to
configure redirections etc.
</p><p>Install Ocsigen Server with:
</p><pre>opam install ocsigenserver
</pre><h3>Use as a library</h3><p>Let's create a new OCaml project with Dune:
<span class="teletype">dune init project mysite</span>
</p><p>To include a Web server in your OCaml program, just add
package <span class="teletype">ocsigenserver</span> to your Dune file, together with all the extensions
you need. For example, modify file <span class="teletype">bin/dune</span> like this:
</p><pre>(executable
 (public_name mysite)
 (name main)
 (libraries
  ocsigenserver
  ocsigenserver.ext.staticmod))
</pre><p>The following command will launch a server, serving static files from 
directory <span class="teletype">static</span>:
</p><pre class=""><code class="language-ocaml translatable">let () = 
  Ocsigen_server.start [ Ocsigen_server.host [Staticmod.run ~dir:&quot;static&quot; ()]]</code></pre><p>Put this in file <span class="teletype">bin/main.ml</span>, and run <span class="teletype">dune exec mysite</span>.
</p><p>By default, the server runs on port 8080. Create a <span class="teletype">static</span> directory
with some files and try to fetch them using your Web browser.
</p><h3>Use as an executable</h3><p>Alternatively, you can run command <span class="teletype">ocsigenserver</span> with a configuration
file:
</p><pre>ocsigenserver -c mysite.conf
</pre><p>The following configuration file corresponds to the program above:
</p><pre>&lt;ocsigen&gt;
  &lt;server&gt;
    &lt;port&gt;8080&lt;/port&gt;
    &lt;extension findlib-package=&quot;ocsigenserver.ext.staticmod&quot;/&gt;
    &lt;host&gt;
      &lt;static dir=&quot;static&quot; /&gt;
    &lt;/host&gt;
  &lt;/server&gt;
&lt;/ocsigen&gt;
</pre></section><section class="docblock"><header><h2>Eliom: Services</h2></header><p>The following code shows how to create a service that answers
for requests at URL <span class="teletype">http://.../aaa/bbb</span>, by invoking an
Ocaml function <span class="teletype">f</span> of type:
</p><pre class=""><code class="language-ocaml translatable">f : (string * string) list -&gt; unit -&gt; string Lwt.t</code></pre><p>Function <span class="teletype">f</span> generates HTML as a string, taking as first argument the list
of URL parameters (GET parameters), and as second argument the list of POST
parameters (here none).
</p><pre class=""><code class="language-ocaml translatable">let f _ () =
  Lwt.return &quot;&lt;html&gt;&lt;head&gt;&lt;title&gt;Hello world&lt;/title&gt;&lt;/head&gt;&lt;body&gt;Welcome&lt;/body&gt;&lt;/html&gt;&quot;

let myservice =
  Eliom_service.create
    ~path:(Eliom_service.Path [&quot;aaa&quot;; &quot;bbb&quot;])
    ~meth:(Eliom_service.Get Eliom_parameter.any)
    ()

let () =
  Eliom_registration.Html_text.register
    ~service:myservice
    f</code></pre><p><span class="teletype">Eliom_service.Get Eliom_parameter.any</span> means that the service uses the GET HTTP method
and takes any GET parameter. The first parameter of function <span class="teletype">f</span> is an association list of GET parameters.
</p><p>Module <span class="teletype">Eliom_registration.Html_text</span> is used to register a service sending
HTML as strings. But we recommend to used typed-HTML instead (see below).</p></section><section class="docblock"><header><h2>Compiling</h2></header><p>In this section, we will show how to compile and run a <em>server-side only</em> Web site by creating your project manually.
</p><p>First, create the directories will we use for data (logs, etc.):
</p><pre>mkdir -p local/var/log/mysite
mkdir -p local/var/data/mysite
mkdir -p local/var/run
</pre><h3>Build an executable</h3><p>This section shows how to create a static executable for you program
(without configuration file).
</p><p>Run the following command:
</p><pre>opam install ocsipersist-sqlite-config eliom
</pre><p>Add packages <span class="teletype">ocsipersist-sqlite</span> and <span class="teletype">eliom.server</span> to file
<span class="teletype">bin/dune</span>, in the &quot;libraries&quot; section.
</p><p>Copy the definition and registration of service <span class="teletype">myservice</span> at the beginning 
of file <span class="teletype">bin/main.ml</span>,
and replace the call to <span class="teletype">Ocsigen_server.start</span> by the following lines:
</p><pre class=""><code class="language-ocaml translatable">let () = 
  Ocsigen_server.start 
    ~command_pipe:&quot;local/var/run/mysite-cmd&quot;
    ~logdir:&quot;local/var/log/mysite&quot;
    ~datadir:&quot;local/var/data/mysite&quot;
    [
      Ocsigen_server.host
       [ Staticmod.run ~dir:&quot;local/var/www/mysite&quot; ()
       ; Eliom.run () ]
    ]</code></pre><p>Build and execute the program with:
</p><pre>dune exec mysite
</pre><p>Open URL <span class="teletype">http://localhost:8080/aaa/bbb</span> with your browser.
</p><h3>Use with ocsigenserver</h3><p>Alternatively, you can decide to build your Eliom app as a library and 
load it dynamically into ocsigenserver using a configuration file.
</p><pre>opam install ocsipersist-sqlite-config eliom
dune init proj --kind=lib mysite
cd mysite
</pre><p>Add <span class="teletype">(libraries eliom.server)</span> into file <span class="teletype">lib/dune</span>.
</p><p>Create your <span class="teletype">.ml</span> files in directory <span class="teletype">lib</span>.
For example, copy the definition and registration of service <span class="teletype">myservice</span> above.
</p><p>Compile:
</p><pre>dune build
</pre><p>Create a configuration file <span class="teletype">mysite.conf</span>
with this content on your project root directory:
</p><pre>&lt;ocsigen&gt;
  &lt;server&gt;
    &lt;port&gt;8080&lt;/port&gt;

    &lt;logdir&gt;local/var/log/mysite&lt;/logdir&gt;
    &lt;datadir&gt;local/var/data/mysite&lt;/datadir&gt;
    &lt;charset&gt;utf-8&lt;/charset&gt;

    &lt;commandpipe&gt;local/var/run/mysite-cmd&lt;/commandpipe&gt;
    &lt;extension findlib-package=&quot;ocsigenserver.ext.staticmod&quot;/&gt;
    &lt;extension findlib-package=&quot;ocsipersist-sqlite-config&quot;/&gt;
    &lt;extension findlib-package=&quot;eliom.server&quot;/&gt;
    &lt;host hostfilter=&quot;*&quot;&gt;
      &lt;static dir=&quot;local/var/www/mysite&quot; /&gt;
      &lt;eliommodule module=&quot;_build/default/lib/mysite.cma&quot; /&gt;
      &lt;eliom/&gt;
    &lt;/host&gt;
  &lt;/server&gt;
&lt;/ocsigen&gt;
</pre><p>Launch the application:
</p><pre>ocsigenserver -c mysite.conf
</pre><p>Open URL <span class="teletype">http://localhost:8080/aaa/bbb</span> with your browser.</p></section><section class="docblock"><header><h2>TyXML: typing HTML</h2></header><p>TyXML statically checks that your OCaml functions will never
generate wrong HTML. For example a program that could generate a paragraph
containing another paragraph will be rejected at compile time.
</p><p>Example of use:
</p><pre class=""><code class="language-ocaml translatable">let open Eliom_content.Html.F in
html
  (head (title (txt &quot;Ex&quot;)) [])
  (body [h1 ~a:[a_id &quot;toto&quot;; a_class [&quot;blah&quot;; &quot;blih&quot;]]
           [txt &quot;Hallo!&quot;]])</code></pre><div class="focused"><h3>How it works</h3><p>TyXML builds the page as an OCaml data-structure using a construction function
for each HTML tag. These functions take as parameters and return nodes
of type <span class="teletype">'a elt</span> where <span class="teletype">'a</span> is a polymorphic variant type added in the
module signature to constrain usage (phantom type).</p></div><h3>Example of typing error</h3><pre class=""><code class="language-ocaml translatable">p [p [txt &quot;Aïe&quot;]]
   ^^^^^^^^^^^^^
Error: This expression has type
         ([&gt; Html_types.p ] as 'a) Eliom_content.Html.F.elt =
           'a Eliom_content.Html.elt
       but an expression was expected of type
         ([&lt; Html_types.p_content_fun ] as 'b) Eliom_content.Html.F.elt =
           'b Eliom_content.Html.elt
       Type 'a = [&gt; `P ] is not compatible with type
         'b =
           [&lt; `A of Html_types.phrasing_without_interactive
            | `Abbr
            | `Audio of Html_types.phrasing_without_media
            ...
            | `Output
            | `PCDATA
            | `Progress
            | `Q
            ...
            | `Wbr ]
       The second variant type does not allow tag(s) `P</code></pre><p>Read more about TyXML in this <a href="html" class="ocsimore_phrasing_link">short tutorial</a> or in its <a href=".././../../tyxml/" class="ocsimore_phrasing_link">user manual</a>.</p></section><section class="docblock"><header><h2>Eliom: Service returning typed HTML</h2></header><p>To use typed HTML, just replace module <span class="teletype">Eliom_registration.Html_text</span>
by  <span class="teletype">Eliom_registration.Html</span>:
</p><pre class=""><code class="language-ocaml translatable">let f _ () =
  Lwt.return
    Eliom_content.Html.F.(html (head (title (txt &quot;&quot;)) [])
                               (body [h1 [txt &quot;Hello&quot;]]))

let myservice =
  Eliom_service.create
    ~path:(Eliom_service.Path [&quot;aaa&quot;; &quot;bbb&quot;])
    ~meth:(Eliom_service.Get Eliom_parameter.any)
    ()

let () =
  Eliom_registration.Html.register
    ~service:myservice
    f</code></pre><h3>Outputs</h3><p>Services can return a typed HTML page as in the example above, but also
any other kind of result. To choose the return type, use the register function
from the corresponding submodule of
<span><a href=".././../../eliom/latest/api/Eliom_registration">Eliom_registration</a></span>:
</p><div id="servicetable"><table><tr><th class="row"><span><a href=".././../../eliom/latest/api/server/Eliom_registration.Html">Html</a></span></th><td colspan="3">Services returning typed HTML pages</td></tr><tr><th class="row"><span><a href=".././../../eliom/latest/api/server/Eliom_registration.Html">Html_text</a></span></th><td colspan="3">Services returning untyped HTML pages as strings</td></tr><tr><th class="row"><span><a href=".././../../eliom/latest/api/server/Eliom_registration.ELIOM_APPL">App</a></span></th><td colspan="3">Apply this functor to generate registration functions for services belonging to an Eliom client/server application. These services also return typed HTML pages, but Eliom will automatically add the client-side program as a JS file, and all the data needed (values of all injections, etc.)</td></tr><tr><th class="row"><span><a href=".././../../eliom/latest/api/server/Eliom_registration.Flow5">Flow</a></span></th><td colspan="3">Services returning portions of HTML pages.</td></tr><tr><th class="row"><span><a href=".././../../eliom/latest/api/server/Eliom_registration.Action">Action</a></span></th><td colspan="3">Services performing actions (server side effects) with or without reloading the page (e.g. login, logout, payment, modification of user information...)</td></tr><tr><th class="row"><span><a href=".././../../eliom/latest/api/server/Eliom_registration.File">Files</a></span></th><td colspan="3">Serve files from the server hard drive</td></tr><tr><th class="row"><span><a href=".././../../eliom/latest/api/server/Eliom_registration.Ocaml">Ocaml</a></span></th><td colspan="3">Services returning OCaml values to be sent to a client side OCaml program (this kind of services is used as low level interface for server functions – see below)</td></tr><tr><th class="row"><span><a href=".././../../eliom/latest/api/server/Eliom_registration.String">String</a></span></th><td colspan="3">Services returning any OCaml string (array of byte)</td></tr><tr><th class="row"><span><a href=".././../../eliom/latest/api/server/Eliom_registration.Redirection">Redirection</a></span></th><td colspan="3">Services returning an HTTP redirection to another service</td></tr><tr><th class="row"><span><a href=".././../../eliom/latest/api/server/Eliom_registration.Any">Any</a></span></th><td colspan="3">To be used to make the service chose what it sends. Call function <span class="teletype">send</span> from the corresponding module to choose the output.</td></tr><tr><th class="row"><span><a href=".././../../eliom/latest/api/server/Eliom_registration.Customize">Customize</a></span></th><td colspan="3">Apply this functor to define your own registration module</td></tr></table></div></section><section class="docblock"><header><h2>Eliom: Typing page parameters</h2></header><p>Instead of taking GET parameters as an untyped <span class="teletype">string * string</span>
association list, you can ask Eliom to decode and check parameter types
automatically.
</p><p>For example, the following code defines a service at URL <span class="teletype">/foo</span>,
that will use GET HTTP method, and take one parameter of type <span class="teletype">string</span>,
named <span class="teletype">s</span>, and one of type <span class="teletype">int</span>, named <span class="teletype">i</span>.
</p><pre class="server" class=""><code class="language-ocaml translatable">let myservice =
  Eliom_service.create
    ~path:(Eliom_service.Path [&quot;foo&quot;])
    ~meth:(Eliom_service.Get (Eliom_parameter.(string &quot;s&quot; ** int &quot;i&quot;)))
    ()</code></pre><p>Then register an OCaml function as handler on this service:
</p><pre class="server" class=""><code class="language-ocaml translatable">let () =
  Eliom_registration.Html.register ~service:myservice
    (fun (s, i) () -&gt;
      Lwt.return
         Eliom_content.Html.F.(html (head (title (txt &quot;&quot;)) [])
                                    (body [h1 [txt (s^string_of_int i)]])))</code></pre><p>The handler takes as first parameter the GET page parameters, typed according to
the parameter specification given while creating the service.
The second parameter is for POST parameters (see below).
</p><p>Recompile you program, and to to URL <span class="teletype">http://localhost:8080/foo?s=hello&amp;i=22</span>
to see the result.
</p><h3>Parameters</h3><p>Module <span><a href=".././../../eliom/latest/api/server/Eliom_parameter">Eliom_parameter</a></span>
is used to describe the type of service parameters.
</p><p>Examples:
</p><pre class=""><code class="language-ocaml translatable">Eliom_parameter.(int &quot;i&quot; ** (string &quot;s&quot; ** bool &quot;b&quot;))
   (* /path?i=42&amp;s=toto&amp;b=on *)

Eliom_parameter.(int &quot;i&quot; ** opt (string &quot;s&quot;))
   (* An integer named i, and an optional string named s *)

Eliom_parameter.(int &quot;i&quot; ** any)
   (* An integer named i, and any other parameters, as an association list
      of type (string * string) list *)

Eliom_parameter.(set string &quot;s&quot;)
   (* /path?s=toto&amp;s=titi&amp;s=bobo *)

Eliom_parameter.(list &quot;l&quot; (int &quot;i&quot;))
   (* /path?l[0]=11&amp;l[1]=2&amp;l[2]=42 *)

Eliom_parameter.(suffix (int &quot;year&quot; ** int &quot;month&quot;))
   (* /path/2012/09 *)

Eliom_parameter.(suffix_prod (int &quot;year&quot; ** int &quot;month&quot;) (int &quot;a&quot;))
   (* /path/2012/09?a=4 *)</code></pre></section><section class="docblock"><header><h2>Eliom: POST services</h2></header><p>To define a service with POST parameters, just change the <span class="teletype">~meth</span> parameter.
For example the following example takes the same GET parameters as the service
above, plus one POST parameter of type string, named &quot;mypostparam&quot;.
</p><pre class="server" class=""><code class="language-ocaml translatable">~meth:(Eliom_service.Post (Eliom_parameter.((string &quot;s&quot; ** int &quot;i&quot;),
                                            (string &quot;mypostparam&quot;))))</code></pre></section><section class="docblock"><header><h2>Eliom: Other kinds of services</h2></header><p>The detailed explanation of services can be found in <span><a href=".././../../eliom/latest/manual/server-services">Eliom's manual</a></span>. Here is a summary:
</p><h3>Pathless services</h3><p>Pathless services are not identified by the path in the URL,
but by a name given as parameter, regardless of the path.
Use this to make a functionality available from all pages
(for example: log-in or log-out actions, add something in a shopping basket ...).
The name can be specified manually
using the <span class="teletype">~name</span> optional parameter, otherwise, a random name is
generated automatically.
This is also used to implement server functions (see below).
If you are programming a client-server Eliom app, you will often prefer
remote procedure calls (`let%rpc`).
</p><pre class="server" class=""><code class="language-ocaml translatable">let pathless_service =
  Eliom_service.create
    ~name:&quot;pathless_example&quot;
    ~path:Eliom_service.No_path
    ~meth:(Eliom_service.Get (Eliom_parameter.(int &quot;i&quot;)))
    ()</code></pre><p>More information
<span><a href=".././../../eliom/latest/manual/server-services#pathless">in the manual</a></span>.
</p><h3>Attached services</h3><p>It is also possible to create services identified by both a path and a
special parameter, using functions
<span><a href=".././../../eliom/latest/api/server/Eliom_service#VALcreate_attached_get">Eliom_service.create_attached_get</a></span> or
<span><a href=".././../../eliom/latest/api/server/Eliom_service#VALcreate_attached_post">Eliom_service.create_attached_post</a></span>.
They take a regular service (with a path) as parameter (<span class="teletype">~fallback</span>).
</p><p>It is also possible to attach an existing pathless service to the URL of
another service, with function
<span><a href=".././../../eliom/latest/api/server/Eliom_service#VALattach">Eliom_service.attach</a></span>.
This allows for example to create a link towards a pathless service,
but on another path.
</p><h3>External services</h3><p>Use <span><a href=".././../../eliom/latest/api/server/Eliom_service#VALextern">Eliom_service.extern</a></span> to create
links or forms towards external Web sites as if they were Eliom services.
</p><h3>Predefined services</h3><p>Use service <span><a href=".././../../eliom/latest/api/server/Eliom_service#VALstatic_dir">(Eliom_service.static_dir ())</a></span>
to create links towards static files (see example below for images).
</p><p>Use service <span><a href=".././../../eliom/latest/api/server/Eliom_service#VALreload_action">Eliom_service.reload_action</a></span> and its variants to create links or forms towards the current URL (reload the page). From a client section, you can also call <span><a href=".././../../ocsigen-start/latest/api/server/Os_lib#VALreload">Os_lib.reload</a></span> to reload the page and restart the client-side program.
</p><p><span><a href=".././../../eliom/latest/manual/server-services">Full documentation about services</a></span>, <a href="interaction" class="ocsimore_phrasing_link">a tutorial about traditional service based Web programming</a>, API documentation of modules <span><a href=".././../../eliom/latest/api/server/Eliom_service">Eliom_service</a></span> and <span><a href=".././../../eliom/latest/api/server/Eliom_registration">Eliom_registration</a></span>.
</p><p>This example shows how to insert an image using <span class="teletype">static_dir</span>:
</p><pre class=""><code class="language-ocaml translatable">img
  ~alt:&quot;blip&quot;
  ~src:(Eliom_content.Html.F.make_uri
         (Eliom_service.static_dir ())
         [&quot;dir&quot; ; &quot;image.jpg&quot;])
  ()</code></pre></section><section class="docblock"><header><h2>Forms and links</h2></header><p>Function <span><a href=".././../../eliom/latest/api/server/Eliom_form_sigs.LINKS#VALa">Eliom_content.Html.F.a</a></span> creates typed links to services with their parameters.
For example, if <span class="teletype">home_service</span> expects no parameter
and <span class="teletype">other_service</span> expects a string and an optional int:
</p><pre class=""><code class="language-ocaml translatable">Eliom_content.Html.F.a ~service:home_service [txt &quot;Home&quot;] ()
Eliom_content.Html.F.a ~service:other_service [txt &quot;Other&quot;] (&quot;hello&quot;, Some 4)</code></pre><p>Module <span><a href=".././../../eliom/latest/api/server/Eliom_content.Html.F">Eliom_content.Html.F</a></span>
defines the form's elements with the usual typed interface from TyXML.
Use this for example if you have a client side program and
want to manipulate the form's content from client side functions
(for example do a server function call with the form's elements' content).
</p><p>In contrast,
module <span><a href=".././../../eliom/latest/api/server/Eliom_content_sigs.LINKS_AND_FORMS.Form">Eliom_content.Html.F.Form</a></span> defines a typed interface
for form elements. Use this for links (see above), or if you program traditional
server-side Web interaction (with or without client-side program). This will statically check that your forms
match the services. Example:
</p><pre class=""><code class="language-ocaml translatable">let open Eliom_content.Html.F in
Form.post_form
 ~service:connection_service
   (fun (name, password) -&gt;
     [fieldset
       [label ~a:[a_for name] [txt &quot;Name: &quot;];
        Form.input ~input_type:`Text ~name:name Form.int;
        br ();
        Form.input
          ~a:[a_placeholder &quot;Password&quot;]
          ~input_type:`Password
          ~name:password
          Form.string;
        br ();
        Form.input ~input_type:`Submit ~value:&quot;Connect&quot; Form.string
      ]]) ()</code></pre><p>As you can see, function
<span><a href=".././../../eliom/latest/api/server/Eliom_content_sigs.LINKS_AND_FORMS.Form#VALpost_form">Eliom_content.Html.F.Form.post_form</a></span>
is used to create a form sending parameters using the POST HTTP method
(and similarly, <span><a href=".././../../eliom/latest/api/server/Eliom_content_sigs.LINKS_AND_FORMS.Form#VALget_form">get_form</a></span> for GET method).
It takes the service as first parameter, and a function that will generate the form.
This function takes the names of the GET or POST parameters as arguments.
</p><p>Form elements (like inputs) are also built from using the
<span><a href=".././../../eliom/latest/api/server/Eliom_content_sigs.LINKS_AND_FORMS.Form">Eliom_content.Html.F.Form</a></span> module.
They take the names as parameters, and a last parameter (like <span class="teletype">Form.int</span> or <span class="teletype">Form.string</span>) to match the expected type.</p></section><section class="docblock"><header><h2>Sessions</h2></header><p>Session data is saved on server side in <em>Eliom references</em>.
</p><p>The following Eliom reference will count the number of visits of a user on a page:
</p><pre class="server" class=""><code class="language-ocaml translatable">let%server count_ref =
  Eliom_reference.eref
    ~scope:Eliom_common.default_session_scope
    0 (* default value for everyone *)</code></pre><p>And somewhere in your service handler, increment the counter:
</p><pre class="server" class=""><code class="language-ocaml translatable">let%lwt count = Eliom_reference.get count_ref in
Eliom_reference.set count_ref (count + 1);
Lwt.return ()</code></pre><p>With function <span><a href=".././../../eliom/latest/api/server/Eliom_reference#VALeref_from_fun">Eliom_reference.eref_from_fun</a></span>,
you can create Eliom references without initial value. The initial value is computed for the session
the first time you use it.
</p><p>An Eliom reference can be persistant (value saved on hard drive) or volatile (in memory).
</p><h3>Scopes</h3><p>Sessions are relative to a browser, and implemented using browser cookies.
But Eliom allows to create Eliom references with other <em>scopes</em> than session:
</p><table><tr><td><span><a href=".././../../eliom/latest/api/server/Eliom_common#VALglobal_scope">global_scope</a></span></td><td>Global value for all the Web server</td></tr><tr><td><span><a href=".././../../eliom/latest/api/server/Eliom_common#VALsite_scope">site_scope</a></span></td><td>Global value for the Eliom app in that subsite of the Web site</td></tr><tr><td><span><a href=".././../../eliom/latest/api/server/Eliom_common#VALdefault_group_scope">default_group_scope</a></span></td><td>Value for a group of sessions. For example Ocsigen Start defines a group of session for each user, making it possible to save server side data for all sessions of a user.</td></tr><tr><td><span><a href=".././../../eliom/latest/api/server/Eliom_common#VALdefault_session_scope">default_session_scope</a></span></td><td>The usual session data, based on browser cookies</td></tr><tr><td><span><a href=".././../../eliom/latest/api/server/Eliom_common#VALdefault_process_scope">default_process_scope</a></span></td><td>Server side data for a given client-side process (a tab of the browser or a mobile app). This is available only with a client-server Eliom app.</td></tr></table><p>Applications based on Ocsigen Start use these scopes for user management.
Session or client process data are discarded when a user logs in or out.
But Ocsigen Start also defines scopes
<span><a href=".././../../ocsigen-start/latest/api/server/Os_session#VALuser_indep_session_scope">Os_session.user_indep_session_scope</a></span>
and
<span><a href=".././../../ocsigen-start/latest/api/server/Os_session#VALuser_indep_process_scope">Os_session.user_indep_process_scope</a></span>
which remain even if a user logs in or out.
</p><p>When session group is not set (for example the user is not connected),
you can still use the group session scope: in that case, the group contains only
one session.</p></section><section class="docblock"><header><h2>Browser events</h2></header><p>By default, event handlers on HTML elements are given as OCaml functions,
but it works only if you have a client-server Eliom program.
If not, you want to give a javascript expression (as a string) instead.
To so that, use attributes functions from module <span class="teletype">Raw</span>. For example
<span><a href=".././../../eliom/latest/api/server/Eliom_content.Html.F.Raw#VALa_onclick">Eliom_content.Html.F.Raw.a_onclick</a></span>
instead of
<span><a href=".././../../eliom/latest/api/server/Eliom_content.Html.F#VALa_onclick">Eliom_content.Html.F.a_onclick</a></span>.
</p><p>Example:
</p><pre class="server" class=""><code class="language-ocaml translatable">Eliom_content.Html.F.(button ~a:[Raw.onclick &quot;alert(\&quot;beep\&quot;);&quot;] [txt &quot;click&quot;])</code></pre></section><section class="docblock"><header><h2>Database access</h2></header><p>You can use your favourite database library with Ocsigen.
Ocsigen Start's template uses
<a href="https://github.com/darioteixeira/pgocaml" class="ocsimore_phrasing_link">PG'OCaml</a>
(typed queries for Postgresql using a PPX syntax extension).
</p><p>Here is an example, taken from Ocsigen Start's demo:
</p><pre class="server" class=""><code class="language-ocaml translatable">let get () =
  full_transaction_block (fun dbh -&gt;
    [%pgsql dbh &quot;SELECT lastname FROM ocsigen_start.users&quot;])</code></pre></section><section class="docblock"><header><h2>Continuation-based Web programming</h2></header><p>Eliom allows the dynamic creation of temporary services.
This is equivalent to a programming pattern known as &quot;continuation-based
Web programming&quot;.
While present in very few Web frameworks,
it is a very powerful feature that can save you a lot of time
when programming a server-side website.
A typical use case is when you have a series of pages,
each of which depending on the entries made on the previous pages,
for example a multi-step train ticket booking.
</p><p>Implementing that without continuation-based Web programming is tedious:
you must store the data previously sent by the user and find a way to
get it for each step of the interaction. It is not possible to save it as
session data, as you want for example to be able to have several different
interactions in different tabs of your browser, or to press the back button of
your browser to go back in the past. This is known as
&quot;the back button problem&quot;.
</p><p>With Eliom, you just need to create new temporary services especially for
one user, that will depend on previous interaction with them.
The form data will be recorded in the closure of the service handler
function.
In our example, you can implement a first page with a form
(departure, destination, date, first name, last name ...).
The form sends this data to another service.
This second service will display a list of train tickets, each with a link
to buy the ticket. Each of these links corresponds to a service that has been
specifically created for this user and train, which will display the payment
page for this ticket.
</p><p>To implement temporary services, we usually use pathless or attached
services (see above). To avoid a memory leak, you can make them temporary using
optional parameters of the service creation function (<span class="teletype">?max_use</span> or <span class="teletype">?timeout</span>).</p></section><section class="docblock"><header><h2>Internationalisation</h2></header><p><a href="https://github.com/besport/ocsigen-i18n" class="ocsimore_phrasing_link">Ocsigen i18n</a>
is an internationalisation library for your OCaml programs.
</p><p>Create a .tsv file with, on each line, a key and the text in several languages:
</p><pre>welcome_message Welcome everybody!        Bienvenue à tous !      Benvenuti a tutti !
</pre><p>and Ocsigen i18n will automatically generate functions like this one:
</p><pre class="shared" class=""><code class="language-ocaml translatable">let%shared welcome_message ?(lang = get_language ()) () () =
  match lang with
  | En -&gt; [txt &quot;Welcome everybody!&quot;]
  | Fr -&gt; [txt &quot;Bienvenue à tous !&quot;]
  | It -&gt; [txt &quot;Benvenuti a tutti !&quot;]</code></pre><p>Ocsigen i18n also defines a syntax extension to use these functions:
</p><pre class="shared" class=""><code class="language-ocaml translatable">Eliom_content.Html.F.h1 [%i18n welcome_message]</code></pre><p>Ocsigen i18n offers many other features:
</p><ul><li> Text can be inserted as a TyXML node (as in the example above) or as a string (ex: <span class="teletype">[%i18n S.welcome_message]</span>),
</li><li> Text can be parametrizable, or contain holes (ex: <span class="teletype">[%i18n welcome ~capitalize:true ~name:&quot;William&quot;]</span>)
</li><li> .tsv file can be split into several modules
</li></ul><p>Have a look at the
<a href="https://github.com/besport/ocsigen-i18n" class="ocsimore_phrasing_link">README file</a>
to see the full documentation,
and see examples in
<a href="https://github.com/ocsigen/ocsigen-start/blob/master/template.distillery/demo_i18n.eliom" class="ocsimore_phrasing_link">Ocsigen Start's template</a>.</p></section><section class="docblock"><header><h2>Ocsigen Server</h2></header><p><em>Ocsigen Server</em> is a full featured Web server.
</p><p>It is now based on <a href="https://github.com/mirage/ocaml-cohttp" class="ocsimore_phrasing_link">Cohttp</a>.
</p><p>It has a powerful
extension mechanism that makes it easy to plug your own OCaml modules
for generating pages. Many extensions are already written:
</p><dl><dt><span><a href=".././../../ocsigenserver/latest/manual/staticmod">Staticmod</a></span>
</dt><dd>    to serve static files.
</dd><dt><a href=".././../../eliom/" class="ocsimore_phrasing_link">Eliom</a>
</dt><dd>    to create reliable client/server Web applications
or Web sites in OCaml using advanced high level concepts.
</dd><dt><span><a href=".././../../ocsigenserver/latest/manual/extendconfiguration">Extendconfiguration</a></span>
</dt><dd>    allows for more options in the configuration file.
</dd><dt><span><a href=".././../../ocsigenserver/latest/manual/accesscontrol">Accesscontrol</a></span>
</dt><dd>    restricts access to the sites from the config file (to requests coming from a subnet, containing some headers, etc.).
</dd><dt><span><a href=".././../../ocsigenserver/latest/manual/authbasic">Authbasic</a></span>
</dt><dd>    restricts access to the sites from the config file using Basic HTTP Authentication.
</dd><dt><span><a href=".././../../ocsigenserver/latest/manual/cgimod">CGImod</a></span>
</dt><dd>    serves CGI scripts. It may also be used to serve PHP through CGI.
</dd><dt><span><a href=".././../../ocsigenserver/latest/manual/deflatemod">Deflatemod</a></span>
</dt><dd>    used to compress data before sending it to the client.
</dd><dt><span><a href=".././../../ocsigenserver/latest/manual/redirectmod">Redirectmod</a></span>
</dt><dd>    sets redirections towards other Web sites from the configuration file.
</dd><dt><span><a href=".././../../ocsigenserver/latest/manual/revproxy">Revproxy</a></span>
</dt><dd>    a reverse proxy for Ocsigen Server.
It allows to ask another server to handle the request.
</dd><dt><span><a href=".././../../ocsigenserver/latest/manual/rewritemod">Rewritemod</a></span>
</dt><dd>    changes incoming requests before sending them to other extensions.
</dd><dt><span><a href=".././../../ocsigenserver/latest/manual/outputfilter">Outputfilter</a></span>
</dt><dd>    rewrites some parts of the output before sending it to the client.
</dd><dt><span><a href=".././../../ocsigenserver/latest/manual/userconf">Userconf</a></span>
</dt><dd>    allows users to have their own configuration files.
</dd><dt><span><a href=".././../../ocsigenserver/latest/manual/comet">Comet</a></span>
</dt><dd>    facilitates server to client communications.
</dd></dl><p>Ocsigen Server has a <span><a href=".././../../ocsigenserver/latest/manual/config">sophisticated configuration</a></span> file mechanism allowing
complex configurations of sites.</p></section></article></div></div></body></html>
